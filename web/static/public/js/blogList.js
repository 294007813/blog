/*! bh-lay.com 2014-06-07 */
define(function(a){a("/frontEnd/lib/juicer.js"),a("/frontEnd/public/css/blog.css");var b,c,d=["{@each list as it,index}",'<div class="articleItem" articleId="${it.id}">','<div class="artItCpt">','<h3><a href="/blog/${it.id}" title="${it.title}" lofox="true" target="_self" >${it.title}</a></h3>',"<p>${it.time_show}</p>","</div>",'<div class="artItCnt">',"{@if it.cover}",'<div class="artItPic">','<a href="/blog/${it.id}" title="${it.title}" lofox="true" target="_self" >','<img src="${it.cover}" alt="${it.title}" />',"</a>","</div>","{@/if}",'<div class="artItInfo"><p>${it.intro}</p></div>','<div class="artItTag">${it.tags}</div>','<div class="artItFoot">','<a class="dataLike" title="我喜欢" href="javascript:void(0)"><i></i><b>8</b></a>','<a class="dataView" title="查看" href="/blog/${it.id}" lofox="true" target="_self"><i></i><b>367</b></a>',"</div>","</div>",'<div class="artItLace">','<div class="artItLaCircle"></div>','<div class="artItLaCorner"><b></b><i></i></div>',"</div>","</div>","{@/each}"].join(""),e=10,f=function(a){console.log("blog list page:","insert html !");var a=a||{},c=$(a.html).hide();a.end?b.hide():b.removeClass("blog_addMore_loading"),b.before(c),c.fadeIn(200)},g=function(a){$.ajax({type:"GET",url:"/ajax/blog",data:{act:"get_list",skip:c,limit:e},success:function(b){var g=b.count,h=b.list;for(var i in h){var j=new Date(parseInt(h[i].time_show));h[i].time_show=j.getYear()+1900+"-"+(j.getMonth()+1)+"-"+j.getDate(),h[i].cover=h[i].cover}var k=juicer(d,{list:h});c+=e,f({end:c>=g?!0:!1,html:k}),a&&a()}})},h=function(a){console.log("blog list page:","bind event !"),console.log("blog list page:","add blog btn [more] !");var c=['<div class="blog_addMore">','<a href="javascript:void(0)">加载更多</a>',"<span>正在加载……</span>","</div>"].join("");b=$(c),a.find(".articleList").append(b),a.on("click",".blog_addMore",function(){b.addClass("blog_addMore_loading"),g()}).on("click",".dataLike",function(){var a=$(this),b=a.offset().left-20,c=a.offset().top-16;L.dialog.tips("交互接口开发中……",{left:b,top:c,delay:2e3})})},i=function(a,b){h(a),b&&b()};return function(a){console.log("blog list page:","start !"),a.html('<div class="articleList"></div>'),c=0,i(a,function(){g(function(){})})}});