/*! bh-lay.com 2014-06-17 */
window.util=window.util||{},function(a){function b(a){var b={};if(a&&a.length>1)for(var c=a.split("&"),d=0;d<c.length;d++)if(c[d]){var e=c[d].split("=");b[e[0]]="undefined"==typeof e[1]?"":e[1]}return b}function c(a,b){if(this.events[a])for(var c=0,d=this.events[a].length;d>c;c++)this.events[a][c].apply(this,b)}function d(){var a=this;this.events={},this.push=null,this.map={},this._router=null,window.history&&window.history.pushState?(this._use="html5",e.call(this)):(this._use="hash",f.call(this)),setTimeout(function(){a.refresh()},10),this.on("change",function(a,b){if(this._router){var c=this._router(a,b);if(c){var d=c[0],e=c[1];this.title(e);for(var f=[],g=2,h=c.length;h>g;g++)f.push(c[g]);this.map[d]&&this.map[d].renderFn.apply(window,f)}}})}var e=function(){var a=this;window.addEventListener("popstate",function(b){var c=b.state||{},d=c.url||null;return d&&a.refresh(d),!1}),this.push=function(a){window.history.pushState({url:a},"test",a)}},f=function(){var a=this,b=!0,c=window.location.hash;"undefined"!=typeof window.onhashchange?window.onhashchange=function(){var d=window.location.hash||"#";c=d;var e=d.replace(/^#/,"");b?a.refresh(e):b=!0}:setInterval(function(){var d=window.location.hash||"#";if(d!=c){c=d;var e=d.replace(/^#/,"");b?b=!0:a.refresh(e)}},50),c.length<2&&(c=window.location.pathname,window.location.hash=c),this.push=function(a){b=!1,this.url=a,window.location.hash=a}};d.prototype={router:function(a){this._router=a},on:function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},set:function(a,b){var a=arguments[0],b="function"==typeof b?b:null;this.map[a]={renderFn:b}},title:function(a){var b=typeof a;b.match(/number|string/)&&(document.title=a)},refresh:function(a){var d;a?d=a:"html5"==this._use?d=window.location.pathname+window.location.search+window.location.hash:"hash"==this._use&&(d=window.location.hash||"#",d=d.replace(/^#/,""));var e=d.length>0?d.split(/\?/):["",""],f=e[0].split("#")[0],g=e[1];f=f.replace(/^\/*|\/*$/g,"");var h=f.split(/\//);1==h.length&&""==h[0]&&(h=[]);var i=b(g);c.call(this,"change",[h,i])}},a.lofox=function(){return new d}}(window.util),define&&define(function(){return window.util.lofox});