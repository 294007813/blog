/*! bh-lay.com 2014-06-07 */
window.util=window.util||{},function(a){function b(a,b){var c=b.offset();a.scrollTop(b.scrollTop()).scrollLeft(b.scrollLeft()).css({position:"absolute",width:b.width(),top:c.top,left:c.left})}function c(a,b){for(var c={"white-space":"pre-wrap"},d=0,e=f.length;e>d;d++)c[f[d]]=b.css(f[d]);a.css(c)}function d(a){var b=a.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />");return b}function e(a){this.dom=$("<div></div>"),this.origin=a,this.state={},c(this.dom,this.origin),b(this.dom,this.origin)}var f=["paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","fontSize","text-align","wordWrap","lineHeight","borderStyle","borderWidth","overflowX","overflowY"];e.prototype={refresh:function(){var a=this.origin.Selection()[0],c=this.origin.val(),e=c.slice(0,a),f=c.slice(a);e=d(e),f=d(f);var g=e+"<span></span>"+f;this.dom.html(g),b(this.dom,this.origin),$("body").append(this.dom);var h=this.dom.find("span").offset(),i={realHeight:this.dom[0].scrollHeight,cursor:{top:h.top-this.origin.scrollTop(),left:h.left}};return this.state=i,this.dom.remove(),i}},a.mirror=function(a){return new e(a)}}(window.util);