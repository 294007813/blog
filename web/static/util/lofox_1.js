/*! bh-lay.com 2014-06-07 */
window.util=window.util||{},function(a){function b(a){a=a.replace(/^\/*|\/*$/g,"");var b=a.split(/\//);return 1==b.length&&""==b[0]&&(b=[]),b}function c(a){var b={};if(a&&a.length>1)for(var c=a.split("&"),d=0;d<c.length;d++)if(c[d]){var e=c[d].split("=");b[e[0]]="undefined"==typeof e[1]?"":e[1]}return b}function d(a,b){if(this.events[a])for(var c=0,d=this.events[a].length;d>c;c++)this.events[a][c].apply(this,b)}function e(){var a=this;window.addEventListener("popstate",function(b){var c=b.state||{},d=c.url||null;return d&&a.refresh(d),!1}),this.push=function(a){window.history.pushState({url:a},"test",a),d.call(this,"change")}}function f(){var a=this,b=!0,c=window.location.hash;"undefined"!=typeof window.onhashchange?window.onhashchange=function(){var d=window.location.hash||"#";c=d;var e=d.replace(/^#/,"");b?a.refresh(e):b=!0}:setInterval(function(){var d=window.location.hash||"#";if(d!=c){c=d;var e=d.replace(/^#/,"");b?b=!0:a.refresh(e)}},50),c.length<2&&(c=window.location.pathname,window.location.hash=c),this.push=function(a){b=!1,this.url=a,window.location.hash=a,d.call(this,"change")}}function g(a,c){var d={},e=null;for(var f in c){var g=b(f);if(g.length==a.length){e=c[f];for(var h=0,i=g.length;i>h;h++)if(g[h]!=a[h]){var j=g[h].match(/{(.+)}/);if(!j){e=null,d={};break}var k=j[1];d[k]=a[h]}if(e)break}}return e?{mapsItem:e,data:d}:!1}function h(){var a=this;this.events={},this.push=null,this._maps={},this._rest=null,window.history&&window.history.pushState?(this._use="html5",e.call(this)):(this._use="hash",f.call(this)),setTimeout(function(){a.refresh()},10)}h.prototype={rest:function(a){"function"==typeof a&&(this._rest=a)},on:function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},set:function(a,b){var a=arguments[0],b="function"==typeof b?b:null;this._maps[a]={renderFn:b}},title:function(a){var b=typeof a;b.match(/number|string/)&&(document.title=a)},refresh:function(a){var d;a?d=a:"html5"==this._use?d=window.location.pathname+window.location.search+window.location.hash:"hash"==this._use&&(d=window.location.hash||"#",d=d.replace(/^#/,""));var e=d.length>0?d.split(/\?/):["",""],f=e[0].split("#")[0],h=e[1],i=b(f),j=c(h),k=g(i,this._maps);if(k){var l=k.data;k.mapsItem.renderFn.call(this,l,i,j),k.mapsItem.title&&this.title(k.mapsItem.title)}else this._rest&&this._rest.call(this,i,j)}},a.lofox=function(){return new h}}(window.util),window.define&&define(function(){return window.util.lofox});